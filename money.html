<!doctype html>
<html lang="en" xmlns="">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>飞瘾犯了-时装</title>
</head>

<link href="css/bootstrap.min.css?v=202404020006" rel="stylesheet" type="text/css">
<link href="css/font-awesome.css?v=4.4.0" rel="stylesheet">

<link href="css/plugins/chosen/chosen.css" rel="stylesheet">
<link href="css/style.css?v=4.1.0" rel="stylesheet">

<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">
	<div class="row">
		<div class="col-sm-12">
			<div class="ibox float-e-margins">
				<div class="ibox-title">
					<h5>价格计算转换</h5>
					<div class="ibox-tools">
						<a class="collapse-link">
							<i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
				<div class="ibox-content">
					<div class="row">
						<div class="col-sm-4">金币比例(1亿):</div>
						<div class="col-sm-4">钻比例(1000钻):</div>
					</div>
					<div class="row">
						<div class="form-group col-sm-4">
							<select data-placeholder="请选择比例..." class="chosen-select" style="min-width:200px" now_g_price onchange="r_input_price()">
								<option value="">请选择比例</option>
							</select>
						</div>
						<div class="form-group col-sm-4">
							<select data-placeholder="请选择比例..." class="chosen-select" style="min-width:200px" now_f_price onchange="r_input_price()">
								<option value="">请选择比例</option>
							</select>
						</div>
					</div>
					<div class="row">
						<div class="form-group col-sm-4">
							<div class="input-group">
								<span class="input-group-addon" style="width: 81px;" >人民币:</span>
								<input type="text" class="form-control" placeholder = "数字" r_price value="1" onblur="r_input_price()">
							</div>
						</div>
						<div class="form-group col-sm-4">
							<div class="input-group">
								<span class="input-group-addon" style="width: 81px;" >金币:</span>
								<input type="text" class="form-control" placeholder = "数字" style="color: red" g_price onblur="g_input_price()">
							</div>
						</div>
						<div class="form-group col-sm-4">
							<div class="input-group">
								<span class="input-group-addon" style="width: 81px;">钻石:</span>
								<input type="text" class="form-control" placeholder = "数字" f_price onblur="f_input_price()">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-sm-3 hide" >
			<div class="ibox float-e-margins ">
				<div class="ibox-title">
					<h5>扫码领红包</h5>
					<div class="ibox-tools">
						<a class="collapse-link">
							<i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
				<div class="ibox-content">
					<img src="img/shaoma.jpg" style="width: 230px;height: 230px" alt="扫码领红包">
				</div>
			</div>

			<div class="ibox float-e-margins hide">
				<div class="ibox-title">
					<h5>操作专区</h5>
					<div class="ibox-tools">
						<a class="collapse-link">
							<i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
				<div class="ibox-content" operation_div>
					<div class="row">
						<div class="form-group col-sm-4">
							<input type="text" class="form-control" img_money placeholder="请输入价格" style="min-width: 100px;" >
						</div>
						<div class="form-group col-sm-4">
							<select data-placeholder="请选择时装..." class="chosen-select" sel_now_show style="min-width: 220px" onchange="sel_img()" ></select>
						</div>
						<div class="form-group col-sm-4">
							<select data-placeholder="请选择移速..." class="chosen-select" sel_img_show style="min-width: 220px"></select>
						</div>
					</div>

					<div class="row">
						<div class="form-group col-sm-4">
							<button style="width: 104px;text-align: center;padding-left: 0;padding-right: 0;" class="btn btn-success" onclick="show_img()" >生成</button>
						</div>
					</div>
				</div>
			</div>

			<div class="ibox float-e-margins hide">
				<div class="ibox-title">
					<h5>自定义上传区域</h5>
					<div class="ibox-tools">
						<a class="collapse-link">
							<i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
				<div class="ibox-content">
					<div class="row">
						<div class="form-group col-sm-4">
							<div class="input-group" >
								<input type="text" class="form-control" file_upload_name placeholder = "请输入名称" style="min-width: 100px;" >
							</div>
						</div>
						<div class="form-group col-sm-4">
							<div class="input-group" >
								<input type="text" class="form-control" file_upload_money placeholder = "请输入价格" style="min-width: 100px;" >
							</div>
						</div>
						<div class="col-sm-4">
							<button class="btn btn-success" onclick="$('#fileUpload').click();">上传文件</button>
						</div>

						<input type="file" id="fileUpload" accept="image/*" style="display: none;" >
					</div>
				</div>
			</div>

			<div class="ibox float-e-margins hide">
				<div class="ibox-title">
					<h5>时装销售区</h5>
					<div class="ibox-tools">
						<a class="dropdown-toggle" onclick="init_show_img()">
							<i class="fa fa-refresh"></i>
						</a>
						<a class="collapse-link" >
							<i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
				<div class="ibox-content">
					<div show_txt_div class="row"></div>
				</div>
			</div>

			<div class="ibox float-e-margins"></div>
		</div>

		<div class="col-sm-6 hide" >
			<div class="ibox float-e-margins">
				<div class="ibox-title">
					<h5>幸运礼盒</h5>
					<div class="ibox-tools">
						<a class="collapse-link">
							<i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
				<div class="ibox-content">
					<div class="row">
						<img alt="image" class="img-circle" src="img/items/syssysscrbxluck.png">
						<button class="btn btn-success" onclick="lucky_box()" >本期时装</button>
					</div>
				</div>
			</div>
			<div class="ibox float-e-margins">
				<div class="ibox-title">
					<h5>成果</h5>
					<div class="ibox-tools">
						<a class="collapse-link">
							<i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
				<div class="ibox-content">
					<div lucky_box_msg_div class="row"></div>
				</div>
			</div>

			<div class="ibox float-e-margins">
				<div class="ibox-title">
					<h5>消息</h5>
					<div class="ibox-tools">
						<a class="collapse-link">
							<i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
				<div class="ibox-content">
					<div txt_div class="row"></div>
				</div>
			</div>

			<div class="ibox float-e-margins"></div>
		</div>
	</div>
</div>
<div class="hide">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_2_Blue_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_2_Blue_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_2_Green_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_2_Green_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_4_Burgundy_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_4_Burgundy_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_6_Purple_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_6_Purple_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_8_Grey_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_8_Grey_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_10_Black_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(F)/Shadow_Hunter_10_Black_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_2_Blue_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_2_Blue_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_2_Green_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_2_Green_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_4_Burgundy_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_4_Burgundy_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_6_Purple_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_6_Purple_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_8_Grey_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_8_Grey_Set/2.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_10_Black_Set/1.png">
	<img src="img/show/Shadow_Hunter/Shadow_Hunter(M)/Shadow_Hunter_10_Black_Set/2.png">
</div>

<!-- 全局js -->
<script src="js/jquery.min.js?v=202404111603"></script>
<script src="js/bootstrap.min.js?v=3.3.6"></script>
<script src="js/base.js?v=202404111603"></script>

<!-- Chosen -->
<script src="js/plugins/chosen/chosen.jquery.js"></script>

<!-- 自定义js -->
<script src="js/content.js?v=1.0.0"></script>
<!-- jQuery UI -->
<script src="js/plugins/jquery-ui/jquery-ui.min.js"></script>

<script>
	$(document).ready(function() {
		//页面元素可移动
		WinMove();

		// 当页面加载完成后，给 body 元素添加自定义光标样式
		$('body').addClass('custom-cursor');

		const config = {
			'.chosen-select': {
				allow_single_deselect: true
			},
			'.chosen-select-deselect': {
				allow_single_deselect: true
			},
			'.chosen-select-no-single': {
				disable_search_threshold: 10
			},
			'.chosen-select-no-results': {
				no_results_text: 'Oops, nothing found!'
			},
			'.chosen-select-width': {
				width: "95%"
			}
		};
		for (const selector in config) {
			$(selector).chosen(config[selector]);
		}

		r_input_price();
	});

	for(let i = 1 ; i <= 100 ; i++){
		$("[now_g_price]").append(`<option ${i===25 ?'selected':''} value="${i}" hassubinfo="true">${i}元</option>`);
		$("[now_f_price]").append(`<option ${i===53 ?'selected':''}  value="${i}" hassubinfo="true">${i}元</option>`);
	}
	for(let i = 0 ; i < show_all_data.length ; i++){
		const obj = show_all_data[i];
		$("[sel_now_show]").append(`<option ${obj.file_name === 'Shadow_Hunter' ?'selected':''} value="${obj.file_name}" hassubinfo="true">${obj.en_name}(${obj.cns_name})</option>`);
	}

	init_show_img();

	$("#fileUpload").on('change', function(e) {
		$("#preview").removeClass("hide");

		const file = e.target.files[0];
		const reader = new FileReader();
		reader.onloadend = function () {
			$('#preview').attr("src",reader.result);

			const upload_money = $("[file_upload_money]").val();
			const upload_name = $("[file_upload_name]").val();


			$("[show_txt_div]").prepend(`
			<div class="col-xs-6">
				<div style="border: 1px #e7eaec solid;margin-bottom: 10px">
					<div style="text-align: center;">
						<span style="font-weight: bold; ">${upload_name}</span>&nbsp;
						<span style="color: red;font-size: 20px;font-weight: bold; ">${upload_money}</span>
					</div>
					<div style="text-align: center">
						<img src="${reader.result}" style="height: 200px" alt="${upload_name}" onerror="error_img(this)">
					</div>
				</div>
			</div>
		`);
		}

		if (file) {
			reader.readAsDataURL(file);
		} else {
			$('#preview').attr("src","");
		}
	});


	function sel_img(){
		let str = ``;
		const show_data = show_all_data.filter(e => e.file_name === $("[sel_now_show]").val())[0];
		for(let i = 0 ; i < show_data.list.length ; i++) {
			const obj = show_data.list[i];
			str += `<option ${i === 0 ?'selected':''} value="${i}" hassubinfo="true">${obj.option_str}</option>`;
		}

		$("[sel_img_show]").html(str);

		$("[sel_img_show]").trigger("chosen:updated");
	}

	function init_show_img(){
		sel_img();
		$("[show_txt_div]").html("");
	}

	function formatNumberWithCommas(num) {
		return Number(num).toLocaleString('en-US', {
			style: 'decimal',
			minimumFractionDigits: 0, // 如果需要小数部分，可以调整这个值
			maximumFractionDigits: 0  // 如果需要小数部分，可以调整这个值
		});
	}

	function r_formatNumberWithCommas(num) {
		let str = Number(num).toLocaleString('en-US', {
			style: 'decimal',
			minimumFractionDigits: 2, // 如果需要小数部分，可以调整这个值
			maximumFractionDigits: 2  // 如果需要小数部分，可以调整这个值
		});

		// 检查字符串是否以".00"结尾
		if (str.endsWith('.00')) {
			// 使用slice()方法移除最后三个字符（即".00"）
			return str.slice(0, -3);
		}

		return str;
	}

	function color_price_input(){
		const g_price = Number($("[g_price]").val().replace(/,/g, ''));
		if(g_price >= 1000000000){
			$("[g_price]").attr("style","color:#990099");
		}else if(g_price >= 100000000){
			$("[g_price]").attr("style","color:red");
		} else if(g_price >= 10000000){
			$("[g_price]").attr("style","color:#f78936");
		} else if(g_price >= 1000000){
			$("[g_price]").attr("style","color:#2b72ef");
		}else{
			$("[g_price]").removeAttr("style");
		}
	}

	function get_now_g_price(){
		//当前金价
		let now_g_price = $("[now_g_price]").val();
		//亿比例
		return now_g_price/100000000;
	}
	function get_now_f_price(){
		//当前金价
		let now_f_price = $("[now_f_price]").val();
		//千比例
		return now_f_price/1000;
	}

	function g_input_price(){
		//当前金价
		let now_g_price = get_now_g_price();
		//当前钻价
		const now_f_price = get_now_f_price();
		//金币
		const g_price = Number($("[g_price]").val().replace(/,/g, ''));

		//计算人民币 金币*当前金价
		let new_r_price = parseFloat(g_price)*parseFloat(now_g_price);
		new_r_price = new_r_price.toFixed(2);
		$("[r_price]").val(r_formatNumberWithCommas(new_r_price));

		//计算钻
		let new_f_price = parseFloat(new_r_price) / parseFloat(now_f_price);
		new_f_price = new_f_price.toFixed(0);
		$("[f_price]").val(formatNumberWithCommas(new_f_price));

		//颜色初始化
		color_price_input();
	}

	function f_input_price(){
		//当前金价
		let now_g_price = get_now_g_price();
		//当前钻价
		const now_f_price = get_now_f_price();
		//钻
		const f_price = Number($("[f_price]").val().replace(/,/g, ''));

		//计算人民币 =  钻*当前钻价
		let new_r_price = parseFloat(f_price) * parseFloat(now_f_price);
		new_r_price = new_r_price.toFixed(2);
		$("[r_price]").val(r_formatNumberWithCommas(new_r_price));

		//计算金币 = 人民币/当前金价
		let new_g_price = parseFloat(new_r_price) / parseFloat(now_g_price);
		new_g_price = new_g_price.toFixed(0);
		$("[g_price]").val(formatNumberWithCommas(new_g_price));

		//颜色初始化
		color_price_input();
	}

	function r_input_price(){
		//当前金价
		let now_g_price = get_now_g_price();
		//当前钻价
		const now_f_price = get_now_f_price();
		//人民币
		const r_price = Number($("[r_price]").val().replace(/,/g, ''));
		$("[r_price]").val(r_formatNumberWithCommas(r_price));

		//计算金币
		let new_g_price = parseFloat(r_price) / parseFloat(now_g_price);
		new_g_price = new_g_price.toFixed(0);
		$("[g_price]").val(formatNumberWithCommas(new_g_price));

		//计算钻
		let new_f_price = parseFloat(r_price) / parseFloat(now_f_price);
		new_f_price = new_f_price.toFixed(0);
		$("[f_price]").val(formatNumberWithCommas(new_f_price));

		//颜色初始化
		color_price_input();
	}

	function error_img(obj){
		obj.onerror=null; obj.src='img/show/none.png'
	}

	function show_img(){

		const sel_now_show = $("[sel_now_show]").val();
		const index = $("[sel_img_show]").val();

		const now_show_data = show_all_data.filter(e=>e.file_name===sel_now_show)[0];

		const show_money = $(`[img_money]`).val();

		$("[show_txt_div]").prepend(`
			<div class="col-xs-6">
				<div style="border: 1px #e7eaec solid;margin-bottom: 10px">
					<div style="text-align: center;">
						<span style="font-weight: bold; color: ${data.color}">${now_show_data.list[index].name}</span>&nbsp;
						<span style="color: red;font-size: 20px;font-weight: bold; ">${show_money}</span>
					</div>
					<div style="text-align: center">
						<img src="img/show/${now_show_data.file_name}/${now_show_data.file_name}(F)/${now_show_data.list[index].url}/1.png" style="width: 80px;height: 200px" alt="${now_show_data.list[index].name}" onerror="error_img(this)">
						<img src="img/show/${now_show_data.file_name}/${now_show_data.file_name}(F)/${now_show_data.list[index].url}/2.png" style="width: 80px;height: 200px" alt="${now_show_data.list[index].name}" onerror="error_img(this)">
						<img src="img/show/${now_show_data.file_name}/${now_show_data.file_name}(M)/${now_show_data.list[index].url}/1.png" style="width: 80px;height: 200px" alt="${now_show_data.list[index].name}" onerror="error_img(this)">
						<img src="img/show/${now_show_data.file_name}/${now_show_data.file_name}(M)/${now_show_data.list[index].url}/2.png" style="width: 80px;height: 200px" alt="${now_show_data.list[index].name}" onerror="error_img(this)">
					</div>
				</div>
			</div>
		`);
	}

	function lucky_box(){
		let randomNum = Math.random().toFixed(2);
		let luck_box_probability = 0;

		const new_show_data = show_all_data.filter(e=>e.file_name==="Shadow_Hunter")[0];

		for(let i=0 ; i < new_show_data.list.length ; i++) {
			const data = new_show_data.list[i];
			if(i > 0){
				luck_box_probability = parseFloat(data.probability) + parseFloat(luck_box_probability);
			}else{
				luck_box_probability = parseFloat(data.probability);
			}
			luck_box_probability = luck_box_probability.toFixed(2);

			//数字是否匹配
			if(randomNum < luck_box_probability){
				lucky_box_num++
				data.open_num++;
				$("[txt_div]").prepend(`
					<div class="row">
						<div class="col-xs-12">
							<img src="img/items/syssysscrbxluck.png" alt="幸运盒子">
							${i === 0 ? "运气太好了!" : ""}恭喜抽中 <span style="font-weight: bold; color: ${data.color}">${data.name}!</span>
							<br>
							<img src="img/show/${new_show_data.file_name}/${new_show_data.file_name}(F)/${data.url}/1.png" style="width: 80px;height: 200px" alt="${data.name}">
							<img src="img/show/${new_show_data.file_name}/${new_show_data.file_name}(F)/${data.url}/2.png" style="width: 80px;height: 200px" alt="${data.name}">
							<img src="img/show/${new_show_data.file_name}/${new_show_data.file_name}(M)/${data.url}/1.png" style="width: 80px;height: 200px" alt="${data.name}">
							<img src="img/show/${new_show_data.file_name}/${new_show_data.file_name}(M)/${data.url}/2.png" style="width: 80px;height: 200px" alt="${data.name}">
						</div>
					</div>
				`);
				break;
			}
		}

		let str = `<div class="row">`;
		for(let i=0 ; i < new_show_data.list.length ; i++) {
			const data = new_show_data.list[i];
			if(data.open_num > 0){
				str+=`
				<div class="col-xs-12">
					<img src="img/items/syssysscrbxluck.png" alt="幸运盒子">抽中 <span style="font-weight: bold;color: ${data.color}">${data.name}</span>*${data.open_num}个 !
				</div>
			`;
			}
		}

		str+=`
			<div class="col-xs-12" style="padding-top: 10px">
				统计:总数${lucky_box_num}个
			</div>
		</div>
		`

		$("[lucky_box_msg_div]").html(str);
	}
</script>

</body>
</html>